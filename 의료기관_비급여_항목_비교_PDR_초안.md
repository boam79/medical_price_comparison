# 📘 의료기관 비급여 항목 비교 프로그램 — PDR (Next.js & Vercel 버전)

## 1. 프로젝트 개요
본 프로젝트는 사용자가 **두 개 이상의 의료기관을 선택**하여 **공통 비급여 항목을 자동 비교**하고,  
가격 차이를 시각적으로 확인할 수 있는 웹 애플리케이션을 구축하는 것을 목표로 한다.  

이 버전은 **Next.js + Vercel** 환경에서 **반응형 웹 및 구글 SEO 최적화**를 중심으로 재설계되었다.  
데이터는 **공공데이터포털 비급여 진료비 API**를 통해 실시간으로 가져온다.

---

## 2. 주요 목표
- 병원 간 **공통 비급여 항목 비교 자동화**
- **모바일·데스크톱 대응 반응형 UI**
- **SEO 친화적 구조 및 메타데이터 구성**
- **서버리스(Next.js API Routes)** 기반의 안정적 API 연동
- **Vercel**을 통한 간편한 배포 및 모니터링

---

## 3. 핵심 기능 정의

| 기능 영역 | 기능 설명 | 세부 요구사항 |
|------------|-------------|----------------|
| **병원 검색** | 시도/시군구 기준 병원 목록 조회 및 이름 검색 | 검색 자동완성, 중복 선택 지원 |
| **비급여 항목 조회** | 선택된 병원의 비급여 항목 API 호출 | 항목명, 코드, 단위, 금액, 보고년도 표시 |
| **항목 비교** | 병원 간 공통 항목 자동 추출 및 가격차 표시 | 금액 차이 기준 정렬, 그래프 표시 |
| **결과 출력** | 필터링·정렬·CSV 내보내기 | 클라이언트 단 CSV 생성 |
| **반응형 UI** | 모바일·데스크톱 전환 자동 대응 | 카드형 요약 → 테이블형 비교 |
| **SEO 최적화** | 구조화 데이터, 메타태그, 사이트맵, 오픈그래프 지원 | 구글 검색 노출 강화 |

---

## 4. 기술 스택 및 인프라

| 구분 | 기술 |
|------|------|
| **Frontend / Server** | Next.js 15 (App Router, SSR/ISR) |
| **UI Framework** | Tailwind CSS, shadcn/ui |
| **Data Fetching** | Next.js Route Handler, SWR |
| **배포 및 호스팅** | Vercel (자동 빌드 & 배포) |
| **데이터 소스** | 공공데이터포털 비급여 진료비 API |
| **로깅/모니터링** | Vercel Logs, (옵션) Sentry |
| **SEO 도구** | Next Metadata API, sitemap, robots, JSON-LD |

---

## 5. 화면 및 UX 요구사항

### (1) 반응형 UX 설계
- **모바일(≤768px)**: 항목별 카드 리스트 형식  
- **태블릿 이상**: 고정 헤더형 테이블 + 가로 스크롤  
- **접근성 준수**: 폰트 16px 이상, 키보드 탐색 지원

### (2) 페이지 구조
| 페이지 | 목적 | 주요 요소 |
|---------|------|-----------|
| `/` | 메인 검색 | 병원 선택, 지역 필터, “비교하기” 버튼 |
| `/compare` | 결과 페이지 | 비교표, 그래프, CSV 다운로드 |
| `/about` | 서비스 소개 | 데이터 출처, 이용 방법 |

---

## 6. SEO 최적화 전략

| 항목 | 구현 내용 |
|------|-------------|
| **SSR 기반 렌더링** | 검색 엔진에 완전한 HTML 제공 |
| **메타데이터 구조화** | title, description, canonical, openGraph, twitter card 설정 |
| **사이트맵 & 로봇제어** | sitemap.xml / robots.txt 자동 생성 |
| **JSON-LD 구조화 데이터** | WebSite, ItemList, Dataset 스키마 적용 |
| **FAQ 섹션** | 자주 묻는 질문 + FAQPage 스키마 적용 |
| **Core Web Vitals 최적화** | next/image, next/font, lazy loading 활용 |

---

## 7. 데이터 구조 및 흐름

1. 사용자가 병원 선택  
2. `/api/noncovered`에서 공공데이터 API 호출  
3. 결과를 정규화(`normalize`) 및 유사도 매칭  
4. `/api/compare`에서 공통 항목 도출  
5. 클라이언트에서 표/그래프로 표시  
6. CSV 내보내기 시 클라이언트에서 File API 사용

---

## 8. 반응형 디자인 원칙

- **모바일 퍼스트 (Mobile First)**  
  - 최소한의 로딩, 세로 중심 구성  
- **플루이드 레이아웃 (Fluid Grid)**  
  - Tailwind breakpoint를 기준으로 `sm`, `md`, `lg`, `xl` 단계 적용  
- **가독성 강화**  
  - 주요 텍스트 대비율 4.5:1 이상, 폰트 16px 이상  
- **대화형 시각요소**  
  - 비교 차이 강조 색상, hover 툴팁 지원  

---

## 9. API 정책 및 해외 IP 차단 대응

공공데이터포털 API는 해외 IP 접근을 차단하므로 다음과 같이 처리한다.

- **서버사이드 요청**: Vercel Route Handler를 통한 API 중계  
- **국내 리전 프록시 서버 (옵션)**: AWS 서울 리전 Lambda  
- **캐시 전략**: Route 캐시 + Upstash Redis (선택)  
- **샘플 데이터 모드**: API 장애 시 fallback JSON 데이터 사용

---

## 10. 보안 및 운영 정책
- `.env` 환경변수를 통한 API Key 보호 (서버 전용)  
- Vercel Secret 기능 사용  
- Preview 배포에는 `robots: noindex` 적용  
- API 호출 제한 및 Rate Limit 설정

---

## 11. 품질 기준

| 항목 | 기준 |
|------|------|
| **로딩 속도** | 2초 이내 (모바일 기준) |
| **Core Web Vitals 점수** | 90점 이상 (PageSpeed 기준) |
| **SEO 점수** | 90점 이상 (Lighthouse 기준) |
| **반응형 완성도** | 4단계 뷰포트(모바일~데스크톱) 대응 |
| **오류 처리율** | 에러 로그 0건 (테스트 케이스 기준) |

---

## 12. 버전 관리 및 배포

- **GitHub 연동 → Vercel 자동 배포**  
- 환경별 분리: `dev`, `preview`, `prod`  
- 배포 로그 및 빌드 상태 모니터링(Vercel Dashboard)  
- 업데이트 시 자동 사이트맵 재생성

---

## 13. 향후 확장 방향
- 병원별 비급여 항목 **가격 변동 트렌드 그래프**
- **지역별 평균가 비교** 기능
- 사용자 즐겨찾기 병원 저장 (Supabase 연동)
- 서비스 다국어화(한국어/영어)

---

## 14. 결론
이 개정판 PDR은 기존 Streamlit 로컬앱 중심 구조를  
**Next.js + Vercel 배포 모델**로 전환한 웹 서비스 버전이다.  

모바일 친화적 UX와 SEO 최적화를 동시에 고려하여,  
**검색 노출 → 사용자 유입 → 서비스 활용률 향상**의 선순환 구조를 목표로 한다.

---

© 2025 의료비 비교 자동화 프로젝트